t("ADOR.Recordset")
test("ADODB.Recordset")
var adVarChar = 200

function test(name) {
    WScript.Echo("Test for " + name);
    var r = new ActiveXObject(name);
    WScript.Echo("Recordset: "+ typeof r);
    WScript.Echo("fields: "+ typeof r["fields"]);
    WScript.Echo("resync: "+ typeof r["fields"]["resync"]);
    WScript.Echo("resync: "+ typeof r["fields"].resync);
    WScript.Echo("item: "+ typeof r["fields"]["item"]);
    r["fields"].append("field1", 200, 255); // 200 = adVarChar
    r["fields"].append("field2", 5); // 5 = adDouble
    WScript.Echo("open()");
    r.open();
    WScript.Echo("resync: "+ typeof r["fields"]["resync"]);
    WScript.Echo("item: "+ typeof r["fields"]["item"]);
    r.AddNew();
    r("field1") = "test";
    r("field2") = 1.1;
    r.update();
    //r.fields.resync()
    WScript.Echo("resync: "+ typeof r["fields"]["resync"]);
    WScript.Echo("item: "+ typeof r["fields"]["item"]);
    r.MoveFirst();
    WScript.Echo("resync: "+ typeof r["fields"]["resync"]);
    WScript.Echo("item: "+ typeof r["fields"]["item"]);
    WScript.Echo("item: "+ typeof r["fields"].item);
    WScript.Echo("item('field1') " +r.fields.item("field1"));

    WScript.Echo();
}

